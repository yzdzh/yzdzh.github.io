<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="php,golang,linux,html,javascript,hexo,前端,vue,星光,天策"><meta name="keywords" content="php,golang,linux,html,javascript,hexo,前端,vue,星光,天策"><link rel="stylesheet" type="text/css" href="//fonts.loli.net/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.5"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.5"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><link rel="stylesheet" type="text/css" href="https://unpkg.com/gitalk/dist/gitalk.css?v=2.0.5"><title>PHP 状态模式 | 星光的博客</title><script data-ad-client="ca-pub-5977992732306814" async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><meta name="generator" content="Hexo 4.2.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">PHP 状态模式</h1><a id="logo" href="/.">星光的博客</a><p class="description">php后端工程师，兼职前端和go开发</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="搜索"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">PHP 状态模式</h1><div class="post-meta"><a href="/post/1157327802.html#comments" class="comment-count"></a><p><span class="date">2017-05-04</span><span><a href="/categories/php/" class="category">php</a></span></p></div><div class="post-content"><h3 id="1-概述"><a href="#1-概述" class="headerlink" title="1.概述"></a>1.概述</h3><p>在软件开发过程中，应用程序可能会根据不同的情况作出不同的处理。最直接的解决方案是将这些所有可能发生的情况全都考虑到。然后使用if… ellse语句来做状态判断来进行不同情况的处理。但是对复杂状态的判断就显得“力不从心了”。随着增加新的状态或者修改一个状体（if else(或switch case)语句的增多或者修改）可能会引起很大的修改，而程序的可读性，扩展性也会变得很弱。维护也会很麻烦。那么我就考虑只修改自身状态的模式。  </p>
<p>例子1：按钮来控制一个电梯的状态，一个电梯开们，关门，停，运行。每一种状态改变，都有可能要根据其他状态来更新处理。例如，开门状体，你不能在运行的时候开门，而是在电梯定下后才能开门。  </p>
<p>例子2：我们给一部手机打电话，就可能出现这几种情况：用户开机，用户关机，用户欠费停机，用户消户等。 所以当我们拨打这个号码的时候：系统就要判断，该用户是否在开机且不忙状态，又或者是关机，欠费等状态。但不管是那种状态我们都应给出对应的处理操作。  </p>
<h3 id="2-问题"><a href="#2-问题" class="headerlink" title="2.问题"></a>2.问题</h3><p>对象如何在每一种状态下表现出不同的行为？  </p>
<h3 id="3-解决方案"><a href="#3-解决方案" class="headerlink" title="3.解决方案"></a>3.解决方案</h3><p>状态模式：允许一个对象在其内部状态改变时改变它的行为。对象看起来似乎修改了它的类。  </p>
<p>在很多情况下，一个对象的行为取决于一个或多个动态变化的属性，这样的属性叫做状态，这样的对象叫做有状态的(stateful)对象，这样的对象状态是从事先定义好的一系列值中取出的。当一个这样的对象与外部事件产生互动时，其内部状态就会改变，从而使得系统的行为也随之发生变化。</p>
<h3 id="4-适用性"><a href="#4-适用性" class="headerlink" title="4.适用性"></a>4.适用性</h3><p>在下面的两种情况下均可使用State模式:<br>if else(或switch case)语句，且这些分支依赖于该对象的状态。这个状态通常用一个或多个枚举常量表示。通常 , 有多个操作包含这一相同的条件结构。 State模式将每一个条件分支放入一个独立的类中。这使得你可以根据对象自身的情况将对象的状态作为一个对象，这一对象可以不依赖于其他对象而独立变化。</p>
<h3 id="5-结构"><a href="#5-结构" class="headerlink" title="5.结构"></a>5.结构</h3><p><img src="https://img-blog.csdnimg.cn/20200504213728865.png" alt="在这里插入图片描述"></p>
<h3 id="6-模式的组成"><a href="#6-模式的组成" class="headerlink" title="6.模式的组成"></a>6.模式的组成</h3><p>环境类（Context）:  定义客户感兴趣的接口。维护一个ConcreteState子类的实例，这个实例定义当前状态。<br>抽象状态类（State）:  定义一个接口以封装与Context的一个特定状态相关的行为。<br>具体状态类（ConcreteState）:  每一子类实现一个与Context的一个状态相关的行为。</p>
<h3 id="7-效果"><a href="#7-效果" class="headerlink" title="7.效果"></a>7.效果</h3><p>State模式有下面一些效果:<br>状态模式的优点：<br>1 、 它将与特定状态相关的行为局部化，并且将不同状态的行为分割开来: State模式将所有与一个特定的状态相关的行为都放入一个对象中。因为所有与状态相关的代码都存在于某一个State子类中, 所以通过定义新的子类可以很容易的增加新的状态和转换。另一个方法是使用数据值定义内部状态并且让 Context操作来显式地检查这些数据。但这样将会使整个Context的实现中遍布看起来很相似的条件if else语句或switch case语句。增加一个新的状态可能需要改变若干个操作, 这就使得维护变得复杂了。State模式避免了这个问题, 但可能会引入另一个问题, 因为该模式将不同状态的行为分布在多个State子类中。这就增加了子类的数目，相对于单个类的实现来说不够紧凑。但是如果有许多状态时这样的分布实际上更好一些, 否则需要使用巨大的条件语句。正如很长的过程一样，巨大的条件语句是不受欢迎的。它们形成一大整块并且使得代码不够清晰，这又使得它们难以修改和扩展。 State模式提供了一个更好的方法来组织与特定状态相关的代码。决定状态转移的逻辑不在单块的 i f或s w i t c h语句中, 而是分布在State子类之间。将每一个状态转换和动作封装到一个类中，就把着眼点从执行状态提高到整个对象的状态。这将使代码结构化并使其意图更加清晰。<br>2、它使得状态转换显式化: 当一个对象仅以内部数据值来定义当前状态时 , 其状态仅表现为对一些变量的赋值，这不够明确。为不同的状态引入独立的对象使得转换变得更加明确。而且, State对象可保证Context不会发生内部状态不一致的情况，因为从 Context的角度看，状态转换是原子的—只需重新绑定一个变量(即Context的State对象变量)，而无需为多个变量赋值</p>
<p>3、 State对象可被共享 如果State对象没有实例变量—即它们表示的状态完全以它们的类型来编码—那么各Context对象可以共享一个State对象。当状态以这种方式被共享时, 它们必然是没有内部状态, 只有行为的轻量级对象。</p>
<p><strong>状态模式的缺点:</strong>  </p>
<p>1) 状态模式的使用必然会增加系统类和对象的个数。<br>2) 状态模式的结构与实现都较为复杂，如果使用不当将导致程序结构和代码的混乱。</p>
<h3 id="8-实现"><a href="#8-实现" class="headerlink" title="8.实现"></a>8.实现</h3><p>我们用电梯的例子来说明：</p>
<p>简单地实现代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ILift</span> </span>&#123;  </span><br><span class="line">    <span class="comment">//电梯的四个状态  </span></span><br><span class="line">    <span class="keyword">const</span> OPENING_STATE = <span class="number">1</span>;  <span class="comment">//门敞状态  </span></span><br><span class="line">    <span class="keyword">const</span> CLOSING_STATE = <span class="number">2</span>;  <span class="comment">//门闭状态  </span></span><br><span class="line">    <span class="keyword">const</span> RUNNING_STATE = <span class="number">3</span>;  <span class="comment">//运行状态  </span></span><br><span class="line">    <span class="keyword">const</span> STOPPING_STATE = <span class="number">4</span>; <span class="comment">//停止状态；  </span></span><br><span class="line">  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">//设置电梯的状态  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">function</span> <span class="title">setState</span><span class="params">($state)</span></span>;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//首先电梯门开启动作  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">function</span> <span class="title">open</span><span class="params">()</span></span>;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//电梯门有开启，那当然也就有关闭了  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span><span class="params">()</span></span>;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//电梯要能上能下，跑起来  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span><span class="params">()</span></span>;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//电梯还要能停下来，停不下来那就扯淡了  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">function</span> <span class="title">stop</span><span class="params">()</span></span>;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 电梯的实现类  </span></span><br><span class="line"><span class="comment"> */</span>   </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Lift</span> <span class="keyword">extends</span>  <span class="title">ILift</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">private</span> $state;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setState</span><span class="params">($state)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">$this</span>-&gt;state = $state;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="comment">//电梯门关闭  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="comment">//电梯在什么状态下才能关闭  </span></span><br><span class="line">        <span class="keyword">switch</span>(<span class="keyword">$this</span>-&gt;state)&#123;  </span><br><span class="line">            <span class="keyword">case</span> ILift::OPENING_STATE:  <span class="comment">//如果是则可以关门，同时修改电梯状态  </span></span><br><span class="line">                <span class="keyword">$this</span>-&gt;setState(ILift::CLOSING_STATE);  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">            <span class="keyword">case</span> ILift::CLOSING_STATE:  <span class="comment">//如果电梯就是关门状态，则什么都不做  </span></span><br><span class="line">                <span class="comment">//do nothing;  </span></span><br><span class="line">                <span class="keyword">return</span> ;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">            <span class="keyword">case</span> ILift::RUNNING_STATE: <span class="comment">//如果是正在运行，门本来就是关闭的，也说明都不做  </span></span><br><span class="line">                <span class="comment">//do nothing;  </span></span><br><span class="line">                <span class="keyword">return</span> ;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">            <span class="keyword">case</span> ILift::STOPPING_STATE:  <span class="comment">//如果是停止状态，本也是关闭的，什么也不做  </span></span><br><span class="line">                <span class="comment">//do nothing;  </span></span><br><span class="line">                <span class="keyword">return</span> ;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">                <span class="keyword">echo</span> <span class="string">'Lift colse &lt;br&gt;'</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//电梯门开启  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">open</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="comment">//电梯在什么状态才能开启  </span></span><br><span class="line">        <span class="keyword">switch</span>(<span class="keyword">$this</span>-&gt;state)&#123;  </span><br><span class="line">            <span class="keyword">case</span> ILift::OPENING_STATE: <span class="comment">//如果已经在门敞状态，则什么都不做  </span></span><br><span class="line">                <span class="comment">//do nothing;  </span></span><br><span class="line">                <span class="keyword">return</span> ;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">            <span class="keyword">case</span> ILift::CLOSING_STATE: <span class="comment">//如是电梯时关闭状态，则可以开启  </span></span><br><span class="line">                <span class="keyword">$this</span>-&gt;setState(ILift::OPENING_STATE);  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">            <span class="keyword">case</span> ILift::RUNNING_STATE: <span class="comment">//正在运行状态，则不能开门，什么都不做  </span></span><br><span class="line">            <span class="comment">//do nothing;  </span></span><br><span class="line">                <span class="keyword">return</span> ;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">            <span class="keyword">case</span> ILift::STOPPING_STATE: <span class="comment">//停止状态，淡然要开门了  </span></span><br><span class="line">                <span class="keyword">$this</span>-&gt;setState(ILift::OPENING_STATE);  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Lift open &lt;br&gt;'</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="comment">///电梯开始跑起来  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">switch</span>(<span class="keyword">$this</span>-&gt;state)&#123;  </span><br><span class="line">            <span class="keyword">case</span> ILift::OPENING_STATE: <span class="comment">//如果已经在门敞状态，则不你能运行，什么都不做  </span></span><br><span class="line">                <span class="comment">//do nothing;  </span></span><br><span class="line">                <span class="keyword">return</span> ;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">            <span class="keyword">case</span> ILift::CLOSING_STATE: <span class="comment">//如是电梯时关闭状态，则可以运行  </span></span><br><span class="line">                <span class="keyword">$this</span>-&gt;setState(ILift::RUNNING_STATE);  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">            <span class="keyword">case</span> ILift::RUNNING_STATE: <span class="comment">//正在运行状态，则什么都不做  </span></span><br><span class="line">                <span class="comment">//do nothing;  </span></span><br><span class="line">                <span class="keyword">return</span> ;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">            <span class="keyword">case</span> ILift::STOPPING_STATE: <span class="comment">//停止状态，可以运行  </span></span><br><span class="line">                <span class="keyword">$this</span>-&gt;setState(ILift::RUNNING_STATE);  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Lift run &lt;br&gt;'</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//电梯停止  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">switch</span>(<span class="keyword">$this</span>-&gt;state)&#123;  </span><br><span class="line">            <span class="keyword">case</span> ILift::OPENING_STATE: <span class="comment">//如果已经在门敞状态，那肯定要先停下来的，什么都不做  </span></span><br><span class="line">                <span class="comment">//do nothing;  </span></span><br><span class="line">                <span class="keyword">return</span> ;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">            <span class="keyword">case</span> ILift::CLOSING_STATE: <span class="comment">//如是电梯时关闭状态，则当然可以停止了  </span></span><br><span class="line">                <span class="keyword">$this</span>-&gt;setState(ILift::CLOSING_STATE);  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">            <span class="keyword">case</span> ILift::RUNNING_STATE: <span class="comment">//正在运行状态，有运行当然那也就有停止了  </span></span><br><span class="line">                <span class="keyword">$this</span>-&gt;setState(ILift::CLOSING_STATE);  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">            <span class="keyword">case</span> ILift::STOPPING_STATE: <span class="comment">//停止状态，什么都不做  </span></span><br><span class="line">                <span class="comment">//do nothing;  </span></span><br><span class="line">                <span class="keyword">return</span> ;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Lift stop &lt;br&gt;'</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">&#125;  </span><br><span class="line">$lift = <span class="keyword">new</span> Lift();   </span><br><span class="line">     </span><br><span class="line"><span class="comment">//电梯的初始条件应该是停止状态   </span></span><br><span class="line">$lift-&gt;setState(ILift::STOPPING_STATE);   </span><br><span class="line"><span class="comment">//首先是电梯门开启，人进去   </span></span><br><span class="line">$lift-&gt;open();   </span><br><span class="line">     </span><br><span class="line"><span class="comment">//然后电梯门关闭   </span></span><br><span class="line">$lift-&gt;close();   </span><br><span class="line">     </span><br><span class="line"><span class="comment">//再然后，电梯跑起来，向上或者向下   </span></span><br><span class="line">$lift-&gt;run();      </span><br><span class="line"> <span class="comment">//最后到达目的地，电梯挺下来   </span></span><br><span class="line">$lift-&gt;stop();</span><br></pre></td></tr></table></figure>
<p>显然我们已经完成了我们的基本业务操作，但是，我们在程序中使用了大量的switch…case这样的判断（if…else也是一样),首先是程序的可阅读性很差，其次扩展非常不方便。一旦我们有新的状态加入的话，例如新加通电和断点状态。我们势必要在每个业务方法里边增加相应的case语句。也就是四个函数open，close，run，stop都需要修改相应case语句。</p>
<p>状态模式：把不同状态的操作分散到不同的状态对象里去完成。看看状态类的uml类图：</p>
<p>代码实现：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> *  </span></span><br><span class="line"><span class="comment"> * 定义一个电梯的接口  </span></span><br><span class="line"><span class="comment"> */</span>   </span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">LiftState</span></span>&#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//定义一个环境角色，也就是封装状态的变换引起的功能变化  </span></span><br><span class="line">    <span class="keyword">protected</span>  $_context;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setContext</span><span class="params">(Context $context)</span></span>&#123;  </span><br><span class="line">        <span class="keyword">$this</span>-&gt;_context = $context;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//首先电梯门开启动作  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">function</span> <span class="title">open</span><span class="params">()</span></span>;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//电梯门有开启，那当然也就有关闭了  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span><span class="params">()</span></span>;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//电梯要能上能下，跑起来  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span><span class="params">()</span></span>;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//电梯还要能停下来，停不下来那就扯淡了  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">function</span> <span class="title">stop</span><span class="params">()</span></span>;  </span><br><span class="line">  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 环境类:定义客户感兴趣的接口。维护一个ConcreteState子类的实例，这个实例定义当前状态。 </span></span><br><span class="line"><span class="comment"> */</span>   </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Context</span> </span>&#123;  </span><br><span class="line">    <span class="comment">//定义出所有的电梯状态  </span></span><br><span class="line">    <span class="keyword">static</span>  $openningState = <span class="keyword">null</span>;  </span><br><span class="line">    <span class="keyword">static</span>  $closeingState = <span class="keyword">null</span>;  </span><br><span class="line">    <span class="keyword">static</span>  $runningState  = <span class="keyword">null</span>;  </span><br><span class="line">    <span class="keyword">static</span>  $stoppingState = <span class="keyword">null</span>;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">self</span>::$openningState = <span class="keyword">new</span> OpenningState();  </span><br><span class="line">        <span class="keyword">self</span>::$closeingState = <span class="keyword">new</span> ClosingState();  </span><br><span class="line">        <span class="keyword">self</span>::$runningState =  <span class="keyword">new</span> RunningState();  </span><br><span class="line">        <span class="keyword">self</span>::$stoppingState = <span class="keyword">new</span> StoppingState();  </span><br><span class="line">  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//定一个当前电梯状态  </span></span><br><span class="line">    <span class="keyword">private</span>  $_liftState;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getLiftState</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;_liftState;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setLiftState</span><span class="params">($liftState)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">$this</span>-&gt;_liftState = $liftState;  </span><br><span class="line">        <span class="comment">//把当前的环境通知到各个实现类中  </span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_liftState-&gt;setContext(<span class="keyword">$this</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">open</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        <span class="keyword">$this</span>-&gt;_liftState-&gt;open();  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        <span class="keyword">$this</span>-&gt;_liftState-&gt;close();  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        <span class="keyword">$this</span>-&gt;_liftState-&gt;run();  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">stop</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        <span class="keyword">$this</span>-&gt;_liftState-&gt;stop();  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 在电梯门开启的状态下能做什么事情  </span></span><br><span class="line"><span class="comment"> */</span>   </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OpenningState</span> <span class="keyword">extends</span> <span class="title">LiftState</span> </span>&#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">/** </span></span><br><span class="line"><span class="comment">     * 开启当然可以关闭了，我就想测试一下电梯门开关功能 </span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="comment">//状态修改  </span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_context-&gt;setLiftState(Context::$closeingState);  </span><br><span class="line">        <span class="comment">//动作委托为CloseState来执行  </span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_context-&gt;getLiftState()-&gt;close();  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//打开电梯门  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">open</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'lift open...'</span>, <span class="string">'&lt;br/&gt;'</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="comment">//门开着电梯就想跑，这电梯，吓死你！  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="comment">//do nothing;  </span></span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//开门还不停止？  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="comment">//do nothing;  </span></span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 电梯门关闭以后，电梯可以做哪些事情  </span></span><br><span class="line"><span class="comment"> */</span>   </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClosingState</span> <span class="keyword">extends</span> <span class="title">LiftState</span> </span>&#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//电梯门关闭，这是关闭状态要实现的动作  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'lift close...'</span>, <span class="string">'&lt;br/&gt;'</span>;  </span><br><span class="line">  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="comment">//电梯门关了再打开，逗你玩呢，那这个允许呀  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">open</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">$this</span>-&gt;_context-&gt;setLiftState(Context::$openningState);  <span class="comment">//置为门敞状态  </span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_context-&gt;getLiftState()-&gt;open();  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//电梯门关了就跑，这是再正常不过了  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">$this</span>-&gt;_context-&gt;setLiftState(Context::$runningState); <span class="comment">//设置为运行状态；  </span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_context-&gt;getLiftState()-&gt;run();  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//电梯门关着，我就不按楼层  </span></span><br><span class="line">      </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">$this</span>-&gt;_context-&gt;setLiftState(Context::$stoppingState);  <span class="comment">//设置为停止状态；  </span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_context-&gt;getLiftState()-&gt;stop();  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 电梯在运行状态下能做哪些动作  </span></span><br><span class="line"><span class="comment"> */</span>   </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RunningState</span> <span class="keyword">extends</span> <span class="title">LiftState</span> </span>&#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//电梯门关闭？这是肯定了  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="comment">//do nothing  </span></span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//运行的时候开电梯门？你疯了！电梯不会给你开的  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">open</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="comment">//do nothing  </span></span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//这是在运行状态下要实现的方法  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'lift run...'</span>, <span class="string">'&lt;br/&gt;'</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//这个事绝对是合理的，光运行不停止还有谁敢做这个电梯？！估计只有上帝了  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">$this</span>-&gt;_context-&gt;setLiftState(Context::$stoppingState); <span class="comment">//环境设置为停止状态；  </span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_context-&gt;getLiftState()-&gt;stop();  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 在停止状态下能做什么事情  </span></span><br><span class="line"><span class="comment"> */</span>   </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StoppingState</span> <span class="keyword">extends</span> <span class="title">LiftState</span> </span>&#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//停止状态关门？电梯门本来就是关着的！  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="comment">//do nothing;  </span></span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//停止状态，开门，那是要的！  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">open</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">$this</span>-&gt;_context-&gt;setLiftState(Context::$openningState);  </span><br><span class="line">        <span class="keyword">$this</span>-&gt;_context-&gt;getLiftState()-&gt;open();  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="comment">//停止状态再跑起来，正常的很  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">$this</span>-&gt;_context-&gt;setLiftState(Context::$runningState);  </span><br><span class="line">        <span class="keyword">$this</span>-&gt;_context-&gt;getLiftState()-&gt;run();  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="comment">//停止状态是怎么发生的呢？当然是停止方法执行了  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'lift stop...'</span>, <span class="string">'&lt;br/&gt;'</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 模拟电梯的动作  </span></span><br><span class="line"><span class="comment"> */</span>   </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">main</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        $context = <span class="keyword">new</span> Context();  </span><br><span class="line">        $context-&gt;setLiftState(<span class="keyword">new</span> ClosingState());  </span><br><span class="line">  </span><br><span class="line">        $context-&gt;open();  </span><br><span class="line">        $context-&gt;close();  </span><br><span class="line">        $context-&gt;run();  </span><br><span class="line">        $context-&gt;stop();  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">Client::main();</span><br></pre></td></tr></table></figure>


<p>参考文章：<a href="https://www.cnblogs.com/nnn123/p/6723729.html" target="_blank" rel="noopener">https://www.cnblogs.com/nnn123/p/6723729.html</a></p>
</div><div class="post-copyright"><blockquote><p>原文作者: xingguang</p><p>原文链接: <a href="https://yzdzh.github.io/post/1157327802.html">https://yzdzh.github.io/post/1157327802.html</a></p><p>版权声明: 转载请注明出处(必须保留作者署名及链接)</p></blockquote></div><div class="tags"></div><div class="post-share"><div class="social-share"><span>分享到:</span></div></div><div class="post-nav"><a href="/post/1062235890.html" class="pre">PHP 单例模式</a><a href="/post/2588474815.html" class="next">PHP 工厂模式</a></div><div id="comments"><div id="container"><script type="text/javascript" src="https://unpkg.com/gitalk/dist/gitalk.min.js?v=2.0.5"></script><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=2.0.5"></script><script>var gitalk = new Gitalk({
  clientID: 'fe51b6fab2e6bc732537',
  clientSecret: '73b392debaae9e2cb42af08aeeb8f9de753b00b8',
  repo: 'blogtalk',
  owner: 'yizhidaozuihou',
  admin: ['yizhidaozuihou'],
  id: md5(window.location.pathname),
  distractionFreeMode: false,
  language: 'zh-CN',
  pagerDirection: 'last'
})
gitalk.render('container')</script></div></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-概述"><span class="toc-text">1.概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-问题"><span class="toc-text">2.问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-解决方案"><span class="toc-text">3.解决方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-适用性"><span class="toc-text">4.适用性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-结构"><span class="toc-text">5.结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-模式的组成"><span class="toc-text">6.模式的组成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-效果"><span class="toc-text">7.效果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-实现"><span class="toc-text">8.实现</span></a></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/post/588796899.html">ssh生成公钥私钥对和远程免密登录</a></li><li class="post-list-item"><a class="post-list-link" href="/post/3848110738.html">Linux下清除docker容器终端输出的全部日志</a></li><li class="post-list-item"><a class="post-list-link" href="/post/3748404520.html">win10开机设置wsl子系统固定内网ip</a></li><li class="post-list-item"><a class="post-list-link" href="/post/2798337741.html">WSL子系统修改默认root登入</a></li><li class="post-list-item"><a class="post-list-link" href="/post/2270783465.html">基于win10 + wsl + ubuntu + terminal的本地开发环境</a></li><li class="post-list-item"><a class="post-list-link" href="/post/527254571.html">docker安装软件环境集合</a></li><li class="post-list-item"><a class="post-list-link" href="/post/1624279696.html">docker打包自定义镜像并上传docker hub</a></li><li class="post-list-item"><a class="post-list-link" href="/post/1452351953.html">phpstrom实用插件集合</a></li><li class="post-list-item"><a class="post-list-link" href="/post/4113924384.html">php获取指定前缀常量便捷操作方法</a></li><li class="post-list-item"><a class="post-list-link" href="/post/1924607937.html">linux设置开机服务自动启动/关闭自动启动命令</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Elasticsearch/">Elasticsearch</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Redis/">Redis</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Redis/yii2/">yii2</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">docker</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/golang/">golang</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo%E6%8A%98%E8%85%BE/">hexo折腾</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/php/">php</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/phpStorm/">phpStorm</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/rabbitmq/">rabbitmq</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/swoole/">swoole</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/vagrant/">vagrant</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/wsl/">wsl</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B6%E4%BB%96%E7%BC%96%E7%A8%8B/">其他编程</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3/">编程思想</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E7%90%90%E7%A2%8E/">编程琐碎</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/">网络协议</a><span class="category-list-count">2</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a><span class="archive-list-count">31</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/">2018</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/">2017</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/">2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/">2015</a><span class="archive-list-count">3</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="http://blog.dbh6.cn" title="大宝神" target="_blank">大宝神</a><ul></ul><a href="http://doc.aiwaly.com/docs/golang/golang-1b9du6af0iu7b" title="go大神笔记" target="_blank">go大神笔记</a><ul></ul><a href="https://learnku.com/docs/gin-gonic/2019/go-gin-document/6149" title="gin框架中文文档" target="_blank">gin框架中文文档</a><ul></ul><a href="https://learnku.com/articles/41230" title="golang第三方包大全" target="_blank">golang第三方包大全</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> |  <a href="/atom.xml">订阅本站</a> |  <a href="/about/">联系博主</a><p><a href="http://www.beian.miit.gov.cn/" style="color:#f72b07" target="_blank">粤ICP备20009929号</a></p></p><p><span> Copyright &copy;<a href="/." rel="nofollow">xingguang.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script type="text/javascript" src="/js/search.json.js?v=2.0.5"></script><script>//百度统计
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?9d26cb37102d613f1bb272ba408ec7b0";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script>//百度自动推送
(function(){
var bp = document.createElement('script');
var curProtocol = window.location.protocol.split(':')[0];
if (curProtocol === 'https') {
bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
}
else {
bp.src = 'http://push.zhanzhang.baidu.com/push.js';
}
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(bp, s);
})();
</script><script>//360搜索自动推送
(function(){
var src = "https://jspassport.ssl.qhimg.com/11.0.1.js?d182b3f28525f2db83acfaaf6e696dba";
document.write('<script src="' + src + '" id="sozz"><\\/script>');
})();</script><div id="fullscreen-img" class="hide"><span class="close"></span></div><script type="text/javascript" src="/js/imgview.js?v=2.0.5" async></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.5" async></script><link rel="stylesheet" type="text/css" href="/share/css/share.css"><script type="text/javascript" src="/share/js/social-share.js" charset="utf-8"></script><script type="text/javascript" src="/share/js/qrcode.js" charset="utf-8"></script></body></html>